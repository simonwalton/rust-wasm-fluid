"use strict";(self.webpackChunkcreate_wasm_app=self.webpackChunkcreate_wasm_app||[]).push([[170,766],{799:(t,e,n)=>{let o;function r(t){o=t}n.d(e,{Ku:()=>f,Or:()=>m,Qk:()=>g,Zf:()=>h,oH:()=>p,oT:()=>r,ug:()=>_}),t=n.hmd(t);const a=new Array(128).fill(void 0);function u(t){return a[t]}a.push(void 0,null,!0,!1);let l=a.length;function i(t){const e=u(t);return function(t){t<132||(a[t]=l,l=t)}(t),e}let d=new("undefined"==typeof TextDecoder?(0,t.require)("util").TextDecoder:TextDecoder)("utf-8",{ignoreBOM:!0,fatal:!0});d.decode();let s=null;function c(t){l===a.length&&a.push(a.length+1);const e=l;return l=a[e],a[e]=t,e}class f{static __wrap(t){t>>>=0;const e=Object.create(f.prototype);return e.__wbg_ptr=t,e}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,t}free(){const t=this.__destroy_into_raw();o.__wbg_fluid_free(t)}static new(t){const e=o.fluid_new(t);return f.__wrap(e)}set_dt(t){o.fluid_set_dt(this.__wbg_ptr,t)}set_iterations(t){o.fluid_set_iterations(this.__wbg_ptr,t)}d(){return i(o.fluid_d(this.__wbg_ptr))}d0(){return i(o.fluid_d0(this.__wbg_ptr))}source_u(){return i(o.fluid_source_u(this.__wbg_ptr))}source_v(){return i(o.fluid_source_v(this.__wbg_ptr))}tick(){o.fluid_tick(this.__wbg_ptr)}}function _(t){i(t)}function h(t){return c(u(t).buffer)}function g(t,e,n){return c(new Float32Array(u(t),e>>>0,n>>>0))}function m(t,e){throw new Error((n=t,r=e,n>>>=0,d.decode((null!==s&&0!==s.byteLength||(s=new Uint8Array(o.memory.buffer)),s).subarray(n,n+r))));var n,r}function p(){return c(o.memory)}},766:(t,e,n)=>{n.r(e),n.d(e,{default:()=>c});const o={blues:[[255,255,204],[161,218,180],[65,182,196],[44,127,184],[37,52,148]],pinks:[[241,238,246],[215,181,216],[223,101,176],[221,28,119],[152,0,67]],redblue:[[215,48,39],[244,109,67],[253,174,97],[254,224,144],[224,243,248],[171,217,233],[116,173,209],[69,117,180]],colourful:[[158,1,66],[213,62,79],[244,109,67],[253,174,97],[254,224,139],[230,245,152],[171,221,164],[102,194,165],[50,136,189],[94,79,162]],pastel:[[141,211,199],[255,255,179],[190,186,218],[190,186,218],[128,177,211],[253,180,98],[179,222,105],[252,205,229]],zebra:[[0,0,0],[255,255,255],[0,0,0],[255,255,255],[0,0,0],[255,255,255],[0,0,0],[255,255,255],[0,0,0]]};let r=document.getElementById("colourmap");Object.entries(o).forEach((t=>{let e=document.createElement("option");e.value=t[0],e.text=t[0],r.add(e)})),r.addEventListener("change",(function(){s.colourMap=o[r.value]}));let a=document.getElementById("dt");a.addEventListener("change",(function(){s.dt=+a.value,s.callback()}));let u=document.getElementById("colourmapInterpolation");u.addEventListener("change",(function(){s.colourmapInterpolation=u.checked,s.callback()}));let l=document.getElementById("iterations");l.addEventListener("change",(function(){s.iterations=+l.value,s.callback()}));let i=document.getElementById("resolution");Object.entries({low:100,medium:200,high:300,veryhigh:500}).forEach((t=>{let e=document.createElement("option");e.value=+t[1],e.text=t[0],i.add(e)})),i.addEventListener("change",(function(){s.resolution=+i.value,s.callback(!0)}));let d=document.getElementById("brushradius");d.addEventListener("change",(function(){s.brushRadius=+d.value,s.callback()}));const s={colourMap:o.blues,dt:.001,colourmapInterpolation:!0,resolution:100,iterations:10,brushRadius:10,callback:(t=!1)=>{}},c=s},170:(t,e,n)=>{n.r(e);var o=n(414),r=n(799);(0,r.oT)(o);var a=n(766);let u;const l=document.getElementById("fluid-canvas"),i=l.getContext("2d");i.imageSmoothingEnabled=!0;let d,s=0;var c=void 0,f=void 0,_=!1;const h=()=>{u=r.Ku.new(a.default.resolution),s=a.default.resolution*a.default.resolution,l.setAttribute("width",a.default.resolution),l.setAttribute("height",a.default.resolution),d=i.createImageData(a.default.resolution,a.default.resolution)},g=(t,e,n)=>Math.min(Math.max(e,t),n),m=(t,e)=>Math.floor(g(Math.floor(e)*a.default.resolution+Math.floor(t),0,s-1)),p=(t,e)=>[t/(l.offsetWidth/a.default.resolution),e/(l.offsetHeight/a.default.resolution)],b=t=>{const e=a.default.colourMap,n=(t=g(t,0,.999))*(e.length-1),o=Math.floor(n),r=o+1,u=n-o;return[0,1,2].map((t=>a.default.colourmapInterpolation?((t,e,n)=>e+(n-e)*t)(u,e[o][t],e[r][t]):e[o][t]))},v=(t,e,n,o)=>Math.sqrt((n-t)*(n-t)+(o-e)*(o-e)),w=(t,e,n)=>{const o=a.default.brushRadius;for(var r=t-o;r<t+o;r++)for(var u=e-o;u<e+o;u++){let a=v(r,u,t,e);a<o&&n(r,u,a)}},E=t=>{const e=l.getBoundingClientRect(),[n,o]=p(t.pageX-e.x,t.pageY-e.y),r=a.default.brushRadius,i=u.d0();w(n,o,((t,e,n)=>{i[m(t,e)]=.5*(1-n/r)}))},y=()=>{u.tick(),k(),requestAnimationFrame(y)},k=()=>{const t=u.d();for(var e=0,n=0;n<s;n++){let[o,r,a]=b(t[n]);d.data[e++]=o,d.data[e++]=r,d.data[e++]=a,d.data[e++]=255}i.putImageData(d,0,0)};h(),k(),requestAnimationFrame(y),l.addEventListener("mousemove",(t=>{const e=l.getBoundingClientRect(),[n,o]=p(t.pageX-e.x,t.pageY-e.y);if(void 0!==c&&v(n,o,c,f)>.01){const e=n-c,r=o-f,a=u.source_u(),l=u.source_v();w(n,o,((t,n,o)=>{const u=m(t,n);a[u]=e,l[u]=r})),_&&E(t)}c=n,f=o})),l.addEventListener("click",E),l.addEventListener("mousedown",(t=>{_=!0})),l.addEventListener("mouseup",(t=>{_=!1})),a.default.callback=(t=!1)=>{u.set_dt(a.default.dt),u.set_iterations(a.default.iterations),i.imageSmoothingEnabled=!1,t&&h()},a.default.callback()},414:(t,e,n)=>{var o=n.w[t.id];for(var r in n.r(e),o)r&&(e[r]=o[r]);n(799),o[""]()}}]);